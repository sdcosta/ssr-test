{"version":3,"sources":["../../src/server/index.js"],"names":["htmlTemplate","styles","reactDom","reduxState","JSON","stringify","createServerlessApp","app","disable","console","log","path","resolve","__dirname","use","express","static","get","req","res","json","message","ServerStyleSheet","getStyleTags","writeHead","end","serverlessApp","module","exports"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAEA,SAASA,YAAT,CAAuBC,MAAvB,EAA+BC,QAA/B,EAAyCC,UAAzC,EAAsD;AAClD,+FAIcF,MAJd,yDAMyBC,QANzB,0EAQmCE,KAAKC,SAAL,CAAgBF,UAAhB,CARnC;AAaH;;AAED,SAASG,mBAAT,GAA+B;AAC3B,QAAMC,MAAM,wBAAZ;AACAA,QAAIC,OAAJ,CAAY,cAAZ;AACAC,YAAQC,GAAR,CAAYC,eAAKC,OAAL,CAAaC,SAAb,EAAwB,YAAxB,CAAZ;AACAN,QAAIO,GAAJ,CAAQ,OAAR,EAAiBC,kBAAQC,MAAR,CAAeL,eAAKC,OAAL,CAAaC,SAAb,EAAwB,YAAxB,CAAf,CAAjB;AACAN,QAAIU,GAAJ,CAAQ,MAAR,EAAgB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACzBA,YAAIC,IAAJ,CAAS,EAAEC,SAAS,aAAX,EAAT;AACJ,KAFD;AAGAd,QAAIU,GAAJ,CAAQ,GAAR,EAAa,UAACC,GAAD,EAAMC,GAAN,EAAc;AACvBV,gBAAQC,GAAR,CAAYC,eAAKC,OAAL,CAAaC,SAAb,EAAwB,YAAxB,CAAZ;AACA,YAAMZ,SAAU,IAAIqB,kCAAJ,EAAD,CAAyBC,YAAzB,EAAf;AACA,YAAMrB,WAAW,4BAAe,8BAAC,gBAAD,OAAf,CAAjB;AACAiB,YAAIK,SAAJ,CAAe,GAAf,EAAoB,EAAE,gBAAgB,WAAlB,EAApB;AACAL,YAAIM,GAAJ,CAAQzB,aAAaC,MAAb,EAAqBC,QAArB,CAAR;AACH,KAND;;AAQA,WAAO,8BAAWK,GAAX,CAAP;AACH;;AAED,IAAMmB,gBAAgBC,OAAOC,OAAP,CAAeF,aAAf,GAA+BpB,qBAArD","file":"index.js","sourcesContent":["import express from 'express'\nimport path from 'path'\nimport serverless from 'serverless-http'\nimport React from 'react'\nimport Layout from '../components/Layout'\nimport { renderToString } from 'react-dom/server'\nimport { ServerStyleSheet } from 'styled-components'\n\nfunction htmlTemplate( styles, reactDom, reduxState ) {\n    return `\n        <!DOCTYPE html>\n        <html>\n            <head>\n                ${styles}\n            </head>\n            <div id=\"app\">${ reactDom }</div>\n            <script>\n                window.REDUX_DATA = ${ JSON.stringify( reduxState ) }\n            </script>\n            <script src=\"./dist/app.js\"></script>\n        </html>\n    `\n}\n\nfunction createServerlessApp() {\n    const app = express()\n    app.disable('x-powered-by')\n    console.log(path.resolve(__dirname, '../../dist'))\n    app.use('/dist', express.static(path.resolve(__dirname, '../../dist')))\n    app.get('/aaa', (req, res) => {\n         res.json({ message: 'hello world' })\n    })\n    app.get('*', (req, res) => {\n        console.log(path.resolve(__dirname, '../../dist'))\n        const styles = (new ServerStyleSheet()).getStyleTags()\n        const reactDom = renderToString(<Layout/>)\n        res.writeHead( 200, { \"Content-Type\": \"text/html\" } );\n        res.end(htmlTemplate(styles, reactDom))\n    })\n\n    return serverless(app)\n}\n\nconst serverlessApp = module.exports.serverlessApp = createServerlessApp()\n\n"]}